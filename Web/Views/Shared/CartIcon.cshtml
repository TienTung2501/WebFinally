@using Microsoft.AspNetCore.Http
@using Newtonsoft.Json
@inject IHttpContextAccessor HttpContextAccessor
@{
    double total = 0;
    List<CartItem> cart;
    const string CARTKEY = "cart";
    var session = HttpContextAccessor.HttpContext.Session;
    string jsoncart = session.GetString(CARTKEY);
    if (jsoncart != null)
        cart = JsonConvert.DeserializeObject<List<CartItem>>(jsoncart);
        }
        
            <li class="hm-minicart">
            <div class="hm-minicart-trigger">
                <span class="item-icon"></span>
                <span class="item-text">
                    £160
                    <span class="cart-item-count">2</span>
                </span>
            </div>
            <span></span>
            <div class="minicart">
                <ul class="minicart-product-list">
                   
                    <li>
                        <a href="single-product.html" class="minicart-product-image">
                            <img src="images/product/small-size/3.jpg" alt="cart products">
                        </a>
                        <div class="minicart-product-details">
                            <h6><a href="single-product.html">Aenean eu tristique</a></h6>
                            <span>£80 x 1</span>
                        </div>
                        <button class="close">
                            <i class="fa fa-close"></i>
                        </button>
                    </li>
                </ul>
                <p class="minicart-total">SUBTOTAL: <span>$@total</span></p>
                <div class="minicart-button">
                    <a asp-action="Cart" asp-controller="ShoppingCart" class="li-button li-button-dark li-button-fullwidth li-button-sm">
                        <span>View Full Cart</span>
                    </a>
                    <a href="checkout.html" class="li-button li-button-fullwidth li-button-sm">
                        <span>Checkout</span>
                    </a>
                </div>
            </div>
        </li>
@* @foreach (var item in cart)
{
    total += item.total;
}
@for (int i = 0; i <= (4 > cart.Count ? cart.Count : 4); i++)
{
    <li>
        <a href="single-product.html" class="minicart-product-image">
            <img src="images/product/small-size/@cart[i].product.Image" alt="cart products">
        </a>
        <div class="minicart-product-details">
            <h6><a href="single-product.html">@cart[i].product.NameProduct</a></h6>
            <span>$@cart[i].product.Price" * "@cart[i].product.Quantity</span>
        </div>
        <button class="close">
            <i class="fa fa-close"></i>
        </button>
    </li>
} *@